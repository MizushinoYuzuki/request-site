<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Palette+Mosaic&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="images/icon/icon_white.png" />
        <title>Mizushino</title>
        <link rel="stylesheet" href="css/pricing-style.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    </head>

    <body class="link-transition">
        <header>
            <nav class="nav-container">
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <ul class="menu" id="nav-menu">
                    <li><a href="index.html">About</a></li>
                    <li><a href="works.html">Works</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <section class="pricing">
                <h2>æ–™é‡‘ã®ç›®å®‰</h2>
                <ul>
                <li>åŸºæœ¬æ–™é‡‘ï¼šÂ¥8,000</li>
                </ul>
            </section>

            <section class="form">
                <h2>ä¾é ¼ãƒ•ã‚©ãƒ¼ãƒ </h2>
                    <form action="https://formspree.io/f/xvgalrbr" method="POST" id="requestForm">
                        <label>
                            ãŠåå‰ï¼š
                            <textarea name="pn" rows="1"></textarea>
                        </label>
                        
                        <label>
                            ä¾é ¼å†…å®¹ï¼š
                            <select name="t" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="c">ã‚«ãƒãƒ¼æ¥½æ›²MV</option>
                                <option value="o">ã‚ªãƒªã‚¸ãƒŠãƒ«æ¥½æ›²MV</option>
                                <option value="3d">3DCG</option>
                                <option value="mg">ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹</option>
                                <option value="v">å‹•ç”»ç·¨é›†ï¼ˆPremiere Proï¼‰</option>
                            </select>
                        </label>
                    
                        <div id="coverOptions" style="display: none;">
                            <label>
                                MVã‚¹ã‚¿ã‚¤ãƒ«ï¼š
                                <select name="cs">
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="h">æœ¬å®¶é¢¨MV</option>
                                    <option value="o">å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«MV</option>
                                    <option value="hg">æœ¬å®¶é¢¨åˆå”±MV</option>
                                    <option value="og">å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«åˆå”±MV</option>
                                </select>
                            </label>
                        </div>

                        <div id="originalOptions" style="display: none;">
                            <label>
                                MVã‚¹ã‚¿ã‚¤ãƒ«ï¼š
                                <select name="os">
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="sp">ã‚·ãƒ³ãƒ—ãƒ«</option>
                                    <option value="st">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</option>
                                    <option value="ly">ãƒªãƒªãƒƒã‚¯MV</option>
                                    <option value="o-cho">åˆå”±</option>
                                </select>
                            </label>
                        </div>
                    
                        <label>
                            ç´æœŸã®å¸Œæœ›ï¼š
                            <select name="d" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="2w">2é€±é–“ä»¥å†…</option>
                                <option value="1m">1æœˆä»¥å†…</option>
                                <option value="2m">2æœˆä»¥å†…</option>
                                <option value="3m">3æœˆä»¥å†…</option>
                                <option value="4m">4æœˆä»¥å†…</option>
                                <option value="5m">5æœˆä»¥å†…</option>
                                <option value="6m">åŠå¹´ä»¥å†…</option>
                                <option value="none">æŒ‡å®šãªã—</option>
                            </select>
                        </label>
                    
                        <label>
                            3DCGã®ä½¿ç”¨ï¼š
                            <select name="cg" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="0">æœªä½¿ç”¨</option>
                                <option value="1">ä¸€éƒ¨ä½¿ç”¨</option>
                                <option value="2">å…¨éƒ¨ä½¿ç”¨</option>
                            </select>
                        </label>

                        <div id="deadline-warning" class="warning-text" style="display: none;">
                            â€»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚„è¤‡é›‘ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ãŸæ˜ åƒã¯åˆ¶ä½œä¸å¯ã¨ãªã‚Šã¾ã™ã€‚
                        </div>
                        
                        <div id="chorusCountOptions" style="display: none;">
                            <label>
                                åˆå”±äººæ•°ï¼š
                                <select name="p" required>
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="1">1äºº</option>
                                    <option value="2">2äºº</option>
                                    <option value="3">3äºº</option>
                                    <option value="4">4äºº</option>
                                    <option value="5">5äººä»¥ä¸Š</option>
                                </select>
                            </label>
                        </div>
                            
                        <label>
                            ã”å¸Œæœ›ã®é€£çµ¡æ‰‹æ®µï¼š
                            <select name="ct" id="contactSelect" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="email">ãƒ¡ãƒ¼ãƒ«</option>
                                <option value="x">X(æ—§Twitter)</option>
                                <option value="discord">Discord</option>
                                <option value="slack">Slack</option>
                            </select>
                        </label>
                            
                        <div id="mailaddress" style="display: none;"><label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼š<input type="email" name="email_id"></label></div>
                        <div id="xDM" style="display: none;"><label>Xã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼š<textarea name="x_id" rows="1"></textarea></label></div>
                        <div id="discordDM" style="display: none;"><label>Discordã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼š<textarea name="discord_id" rows="1"></textarea></label></div>
                        <div id="slackDM" style="display: none;"><label>Slackï¼š<textarea name="slack_id" rows="1"></textarea></label></div>
                    
                        <fieldset>
                            <legend>è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆè©²å½“ã™ã‚‹ã‚‚ã®ã«ãƒã‚§ãƒƒã‚¯ï¼‰</legend>
                            <div id="originalOptions-checkbox" style="display: none; margin-bottom: 1.3rem;">
                                <label><input type="checkbox" name="opt" value="sb"> çµµã‚³ãƒ³ãƒ†ã‹ã‚‰ã®æ‰“ã¡åˆã‚ã›ã‚’å¸Œæœ›ã™ã‚‹</label>
                            </div>
                            <label><input type="checkbox" name="opt" value="hs" /> ç«‹ã¡çµµã®é«ªæºã‚Œã‚ã‚Š</label><br />
                            <label><input type="checkbox" name="opt" value="nc" /> ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¨˜è¼‰ãªã—</label><br />
                            <label><input type="checkbox" name="opt" value="ct" /> è‘—ä½œæ¨©è­²æ¸¡</label><br />
                            <label><input type="checkbox" name="opt" value="cu" /> å•†ç”¨åˆ©ç”¨</label><br />
                            <label><input type="checkbox" name="opt" value="np" /> ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæ²è¼‰ä¸å¯</label><br />
                            <label><input type="checkbox" name="opt" value="bd" />é§†ã‘å‡ºã—ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å¿œæ´å€¤å¼•ã<br />
                            <small>â€» æ´»å‹•é–‹å§‹ã‹ã‚‰1å¹´ä»¥å†…ã®æ´»å‹•è€…ã•ã¾ã®ã¿ã§ã™ã€‚<br />â€» æœˆ1ã®ã¿ã®å¯¾å¿œã¨ãªã‚Šã¾ã™ã€‚</small>
                        </label>
                        </fieldset>
                    
                        <label>
                            ãã®ä»–ã”è¦æœ›ï¼š
                            <textarea name="msg" rows="4"></textarea>
                        </label>

                        <div id="price-breakdown"></div>
                        <div id="totalDisplay">åˆè¨ˆé‡‘é¡: Â¥0</div>
                        <button type="submit">ãƒ•ã‚©ãƒ¼ãƒ ã«é€ä¿¡</button>
                    </form>

                <div class="share-buttons">
                    <button id="shareViaEmail" type="button" title="ãƒ¡ãƒ¼ãƒ«ã§å…±æœ‰">
                        <i class="fa-solid fa-envelope"></i>
                    </button>
                    <button id="shareViaUrl" type="button" title="URLã‚’ã‚³ãƒ”ãƒ¼">
                        <i class="fa-solid fa-link"></i>
                    </button>
                    <button id="shareViaText" type="button" title="å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼">
                        <i class="fa-solid fa-clipboard"></i>
                    </button>
                </div>
            </section>

            <script>
            document.addEventListener("DOMContentLoaded", function () {
                // --- è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ---
                const priceConfig = {
                    base: 8000,
                    cg: {
                        "1": { price: 10000, text: "3DCGä¸€éƒ¨ä½¿ç”¨" },
                        "2": { price: 20000, text: "3DCGå…¨éƒ¨ä½¿ç”¨" }
                    },
                    p: {
                        "2": { price: 2000, text: "åˆå”±äººæ•°(2äºº)" },
                        "3": { price: 4000, text: "åˆå”±äººæ•°(3äºº)" },
                        "4": { price: 6000, text: "åˆå”±äººæ•°(4äºº)" },
                        "5": { price: 8000, text: "åˆå”±äººæ•°(5äººä»¥ä¸Š)" }
                    },
                    d: {
                        "2w": { price: 10000, text: "ç‰¹æ€¥ç´å“(2é€±é–“ä»¥å†…)" }
                    },
                    os: { 
                        "st": { price: 15000, text: "MVã‚¹ã‚¿ã‚¤ãƒ«(ã‚¹ãƒˆãƒ¼ãƒªãƒ¼)" },
                        "ly": { price: 5000, text: "MVã‚¹ã‚¿ã‚¤ãƒ«(ãƒªãƒªãƒƒã‚¯)" },
                    opt: {
                        hs: { price: 2000, text: "ç«‹ã¡çµµã®é«ªæºã‚Œ" }, 
                        nc: { price: 10000, text: "ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¨˜è¼‰ãªã—" }, 
                        ct: { multiplier: 1.5, text: "è‘—ä½œæ¨©è­²æ¸¡" },
                        cu: { multiplier: 1.5, text: "å•†ç”¨åˆ©ç”¨" }, 
                        np: { multiplier: 2, text: "ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæ²è¼‰ä¸å¯" }, 
                        bd: { isDiscount: true, text: "é§†ã‘å‡ºã—ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å¿œæ´å€¤å¼•ã" }
                    }
                };
        
                // --- è¦ç´ ã®å–å¾— ---
                const form = document.getElementById("requestForm");
                const allInputs = form.querySelectorAll('select, input[type="checkbox"], textarea');
                const totalDisplay = document.getElementById("totalDisplay");
                const myTypeSelect = document.querySelector('select[name="t"]');
                const contactSelect = document.getElementById("contactSelect");
                const deliverySelect = document.querySelector('select[name="d"]');
                const cgSelect = document.querySelector('select[name="cg"]');
                const deadlineWarning = document.getElementById('deadline-warning');
                const coverStyleSelect = document.querySelector('select[name="cs"]');
                const originalStyleSelect = document.querySelector('select[name="os"]');
                const breakdownContainer = document.getElementById('price-breakdown');
                
                const uiGroups = {
                    t: {
                        c: [document.getElementById("coverOptions")],
                        o: [document.getElementById("originalOptions")]
                    },
                    ct: {
                        email: [document.getElementById("mailaddress")], x: [document.getElementById("xDM")],
                        discord: [document.getElementById("discordDM")], slack: [document.getElementById("slackDM")]
                    }
                };
        
                let lastCalculatedTotal = 0;
        
                // --- é–¢æ•°å®šç¾© ---
                function calculate() {
                    const formData = new FormData(form);
                    const breakdown = {
                        items: [{ text: 'åŸºæœ¬æ–™é‡‘', price: priceConfig.base }],
                        multipliers: [],
                        hasDiscount: false
                    };
                    
                    let total = priceConfig.base;
                    let multiplier = 1;

                    const cgVal = formData.get("cg");
                    const dVal = formData.get("d");
                    const osVal = formData.get("os");
                    const csVal = formData.get("cs");
                    const pVal = formData.get("p");
                    const options = formData.getAll('opt');

                    const addItem = (config, value) => {
                        if (config && config[value]) {
                            const item = config[value];
                            if (item.price) {
                                total += item.price;
                                breakdown.item.push({ text: item.text, price: item.price });
                            }
                        }
                    };

                    addItem(priceConfig.cg, cgVal);
                    addItem(priceConfig.d, dVal);
                    addItem(priceConfig.os, osVal);

                    if (coverStyle === 'hg' || coverStyle === 'og' || originalStyle === 'o-cho') {
                        addItem(priceConfig.p, pVal);
                    }

                    options.forEach(value => {
                        const effect = priceConfig.opt[value];
                        if (!effect) return;
                        if (effect.price) addItem(priceConfig.opt, value);
                        if (effect.multiplier) {
                            multiplier *= effect.multiplier;
                            breakdown.multiplier.push(`${effect.text} (x${effect.multiplier})`);
                        }
                        if (effect.isDiscount) breakdown.hasDiscount = true;
                    });

                    let finalTotal = total * multiplier;
                    let discountAmount = 0;

                    if (breakdown.hasDiscount) {
                        const discountedTotal = finalTotal / 2;
                        const totalAfterFloor = Math.max(discountedTotal, 8000);
                        discountAmount = finalTotal - totalAfterFloor;
                        finalTotal = totalAfterFloor;
                    }

                    lastCalculatedTotal = Math.round(finalTotal);
                    totalDisplay.textContent = `ğŸ§® å‚è€ƒæ–™é‡‘ï¼šÂ¥${lastCalculatedTotal.toLocaleString()}`;

                    let breakdownHtml = '<ul>';
                    breakdown.items.forEach(item => {
                        breakdownHtml += `<li><span class="item-text">${item.text}</span><span class="item-price">Â¥${item.price.toLocaleString()}</span></li>`;
                    });
                    breakdownHtml += '</ul>';

                    if (breakdown.multipliers.length > 0) {
                        breakdownHtml += `<div class="summary-item">${breakdown.multipliers.join(', ')}</div>`;
                    }
                    if (discountAmount > 0) {
                        breakdownHtml += `<div class="summary-item">${priceConfig.opt.bd.text}: - Â¥${Math.round(discountAmount).toLocaleString()}</div>`;
                    }

                    const showBreakdown = breakdown.item.length > 1 || breakdown.multipliers.length > 0 || discountAmount > 0;
                    breakdownContainer.style.display = showBreakdown ? 'block' : 'none';
                    breakdownContainer.innerHTML = breakdownHtml;
                }
        
                function updateUrlFromState() {
                    const params = new URLSearchParams();
                    allInputs.forEach(input => {
                        const name = input.name;
                        if (!name || input.disabled || input.closest('[style*="display: none"]')) return;
                        if (input.type === 'checkbox') {
                            if (input.checked) params.append(name, input.value);
                        } else if (input.value) {
                            params.append(name, input.value);
                        }
                    });
                    const newUrl = `${window.location.pathname}?${params.toString()}`;
                    history.replaceState({}, '', newUrl);
                }
        
                function applyStateFromUrl() {
                    const params = new URLSearchParams(window.location.search);
                    params.forEach((value, key) => {
                        const elements = form.elements[key];
                        if (!elements) return;
        
                        if (elements.nodeName === 'FIELDSET' || (elements.length && !elements.tagName)) { 
                            const values = params.getAll(key);
                            Array.from(elements).forEach(el => {
                                if (el.type === 'checkbox') el.checked = values.includes(el.value);
                            });
                        } else {
                            elements.value = value;
                        }
                    });
                    updateDependentUI();
                }
        
                function toggleVisibility(group, selectedKey) {
                    Object.entries(group).forEach(([key, elements]) => {
                        elements.forEach(el => {
                            el.style.display = (key === selectedKey) ? 'block' : 'none';
                        });
                    });
                }
        
                // â˜…â˜…â˜… å‰²å¼•ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‰Šé™¤ â˜…â˜…â˜…
                function updateDependentUI() {
                    const selectedType = myTypeSelect.value;
                    toggleVisibility(uiGroups.t, selectedType);
                    toggleVisibility(uiGroups.ct, contactSelect.value);
        
                    if (selectedType !== 'c') {
                        coverStyleSelect.value = '';
                    }
                    if (selectedType !== 'o') {
                        originalStyleSelect.value = '';
                    }
        
                    const isCoverChorus = (coverStyleSelect.value === 'hg' || coverStyleSelect.value === 'og');
                    const isOriginalChorus = (originalStyleSelect.value === 'o-cho');
                    const showChorusCount = isCoverChorus || isOriginalChorus;
        
                    document.getElementById('chorusCountOptions').style.display = showChorusCount ? 'block' : 'none';
        
                    if (!showChorusCount) {
                        const chorusSelect = document.querySelector('select[name="p"]');
                        if (chorusSelect) chorusSelect.value = '1';
                    }
        
                    const isExpress = (deliverySelect.value === '2w');
                    cgSelect.disabled = isExpress;
                    deadlineWarning.style.display = isExpress ? 'block' : 'none';
        
                    if (isExpress && cgSelect.value !== '0') {
                        cgSelect.value = '0';
                    }
                }
        
                function handleFormChange() {
                    updateDependentUI();
                    calculate();
                    updateUrlFromState();
                }
                
                function copyToClipboard(text, message) {
                    navigator.clipboard.writeText(text).then(() => alert(message)).catch(() => alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"));
                }
                
                function getFullTextFromValue(name, value) {
                    if (!value) return '(æœªé¸æŠ)';
                    const el = document.querySelector(`select[name="${name}"] option[value="${value}"]`);
                    return el ? el.textContent : value;
                }
                
                function generateFullTextSummary() {
                    const formData = new FormData(form);
                    const selectedOptionsText = [];
                    formData.getAll('opt').forEach(value => {
                        const label = document.querySelector(`input[name="opt"][value="${value}"]`).parentElement.textContent.trim();
                        selectedOptionsText.push(`- ${label}`);
                    });
                    
                    let styleDetails = '';
                    const type = formData.get('t');
                    if (type === 'c') {
                        styleDetails = `  - MVã‚¹ã‚¿ã‚¤ãƒ«: ${getFullTextFromValue('cs', formData.get('cs'))}`;
                    } else if (type === 'o') {
                        styleDetails = `  - MVã‚¹ã‚¿ã‚¤ãƒ«: ${getFullTextFromValue('os', formData.get('os'))}`;
                    }
        
                    const isChorus = (formData.get('cs') === 'hg' || formData.get('cs') === 'og' || formData.get('os') === 'o-cho');
                    const chorusCountText = isChorus ? `\nâ– åˆå”±äººæ•°:\n${getFullTextFromValue('p', formData.get('p'))}` : '';
        
                    const summary = `ã€ã”ä¾é ¼å†…å®¹ã®ã”ç›¸è«‡ã€‘
        â– ãŠåå‰:
        ${formData.get('pn') || '(æœªè¨˜å…¥)'}
        â– ã”ä¾é ¼å†…å®¹:
        ${getFullTextFromValue('t', formData.get('t'))}
        ${styleDetails}
        â– ç´æœŸã®å¸Œæœ›:
        ${getFullTextFromValue('d', formData.get('d'))}
        â– 3DCGã®ä½¿ç”¨:
        ${getFullTextFromValue('cg', formData.get('cg'))}${chorusCountText}
        â– è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³:
        ${selectedOptionsText.length > 0 ? selectedOptionsText.join('\n') : 'ãªã—'}
        â– ã”å¸Œæœ›ã®é€£çµ¡æ‰‹æ®µ:
        ${getFullTextFromValue('ct', formData.get('ct'))}
        â– ãã®ä»–ã”è¦æœ›:
        ${formData.get('msg') || '(æœªè¨˜å…¥)'}
        ---------------------------------
        â– å‚è€ƒæ–™é‡‘: Â¥${lastCalculatedTotal.toLocaleString()}`;
                    return summary.trim();
                }
                
                // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã¨åˆæœŸåŒ– ---
                
                allInputs.forEach(input => input.addEventListener('change', handleFormChange));
                document.getElementById("shareViaEmail").addEventListener('click', () => {
                    const recipientEmail = "mirock.works@gmail.com";
                    const subject = "ã”ä¾é ¼å†…å®¹ã®ã”ç›¸è«‡";
                    const body = `å‚è€ƒæ–™é‡‘çµæœã«ãªã‚Šã¾ã™ã€‚\n\n${window.location.href}\né‡‘é¡: Â¥${lastCalculatedTotal.toLocaleString()}\n\n--- ã”ä¾é ¼æ¦‚è¦ï¼ˆæ›²åãªã©ï¼‰ã‚’ã“ã¡ã‚‰ã«æ›¸ã„ã¦ãã ã•ã„ã€‚ ---\n\nã”ç¢ºèªã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`;
                    window.location.href = `mailto:${recipientEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                });
                document.getElementById("shareViaUrl").addEventListener('click', () => copyToClipboard(window.location.href, "ã“ã®ãƒšãƒ¼ã‚¸ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚"));
                document.getElementById("shareViaText").addEventListener('click', () => copyToClipboard(generateFullTextSummary(), "ã”ä¾é ¼å†…å®¹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚"));
                document.getElementById("hamburger").addEventListener("click", function () {
                    this.classList.toggle("active");
                    document.getElementById("nav-menu").classList.toggle("show");
                });
            
                applyStateFromUrl();
                calculate();
            });
        </script>
        </main>
    </body>
</html>






