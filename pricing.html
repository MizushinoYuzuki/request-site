<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Palette+Mosaic&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="images/icon/icon_white.png" />
        <title>Mizushino</title>
        <link rel="stylesheet" href="css/pricing-style.css" />
    </head>

    <body class="link-transition">
        <header>
            <nav class="nav-container">
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <ul class="menu" id="nav-menu">
                    <li><a href="index.html">About</a></li>
                    <li><a href="works.html">Works</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <!-- <h1>ご依頼について</h1>
                <p>以下の内容をご確認の上、フォームからご相談ください。</p> -->
            </nav>
        </header>

        <main>
            <section class="pricing">
                <h2>料金の目安</h2>
                <ul>
                <li>基本料金：¥8,000</li>
                </ul>
            </section>

            <section class="form">
                <h2>依頼フォーム</h2>
                <form action="https://formspree.io/f/xvgalrbr" method="POST">
                <label>
                    お名前：
                    <textarea name="penname" rows="1"></textarea>
                </label>

                <!-- <label>
                    SNS：
                    <textarea name="sns" rows="4"></textarea>
                </label> -->
                
                <label>
                    依頼内容：
                    <select name="type" id="mvType" required>
                    <option value="">選択してください</option>
                    <option value="cover">カバー楽曲MV</option>
                    <option value="original">オリジナル楽曲MV</option>
                    <option value="3dcg">3DCG</option>
                    <option value="motion">モーショングラフィックス</option>
                    <option value="video">動画編集（Premiere Pro）</option>
                    </select>
                </label>

                <div id="coverOptions" style="display: none; /* margin-top: 1rem; */ ">
                    <label>
                        MVスタイル：
                        <select name="coverStyle">
                            <option value="">選択してください</option>
                            <option value="honke">本家風MV</option>
                            <option value="original_cover">完全オリジナルMV</option>
                        </select>
                    </label>
                </div>

                <label>
                    納期の希望：
                    <select name="count" required>
                    <option value="">選択してください</option>
                    <option>2週間以内</option>
                    <option>1月以内</option>
                    <option>2月以内</option>
                    <option>3月以内</option>
                    <option>4月以内</option>
                    <option>5月以内</option>
                    <option>半年以内</option>
                    <option>指定なし</option>
                    </select>
                </label>

                <label>
                    3DCGの使用：
                    <select name="3DCG使用" required>
                    <option value="">選択してください</option>
                    <option>未使用</option>
                    <option>一部使用</option>
                    <option>全部使用</option>
                    </select>
                </label>

                <label>
                    合唱人数（+1人ごとに+¥2,000）：
                    <select name="合唱人数" required>
                    <option value="">選択してください</option>
                    <option>1人</option>
                    <option>2人</option>
                    <option>3人</option>
                    <option>4人</option>
                    <option>5人以上</option>
                    </select>
                </label>

                <label>
                    ご希望の連絡手段：
                    <select name="contact" id="contactSelect" required>
                    <option value="">選択してください</option>
                    <option value="メール">メール</option>
                    <option value="XのDM">X(旧Twitter)</option>
                    <option value="Discord">Discord</option>
                    <option value="Slack">Slack</option>
                    </select>
                </label>
                    
                <div id="mailaddress" style="display: none;">
                    <label>
                        メールアドレス：
                        <input type="email" name="email">
                    </label>
                </div>

                <div id="xDM" style="display: none;">
                    <label>
                        Xのアカウント：
                        <textarea name="xAccount" rows="1"></textarea>
                    </label>
                </div>

                <div id="discordDM" style="display: none;">
                    <label>
                        Discordアカウント：
                        <textarea name="discordAccount" rows="1"></textarea>
                    </label>
                </div>

                <div id="slackDM" style="display: none;">
                    <label>
                        Slack：
                        <textarea name="slackAccount" rows="1"></textarea>
                    </label>
                </div>

                <fieldset>
                    <legend>追加オプション（該当するものにチェック）</legend>
                    <div id="originalOptions" style="display: none; margin-bottom: 1.3rem;">
                        <label>
                            <input type="checkbox" name="storyboardMeeting">
                            絵コンテからの打ち合わせを希望する
                        </label>
                    </div>
                    <label><input type="checkbox" name="オプション" value="立ち絵の髪揺れあり" /> 立ち絵の髪揺れあり</label><br />
                    <label><input type="checkbox" name="オプション" value="クレジット記載なし" /> クレジット記載なし</label><br />
                    <label><input type="checkbox" name="オプション" value="著作権譲渡" /> 著作権譲渡</label><br />
                    <label><input type="checkbox" name="オプション" value="商用利用" /> 商用利用</label><br />
                    <label><input type="checkbox" name="オプション" value="ポートフォリオ掲載不可" /> ポートフォリオ掲載不可</label><br />
                    <label><input type="checkbox" name="オプション" value="駆け出しクリエイター応援値引き" />駆け出しクリエイター応援値引き<br />
                    <small>
                        ※ 活動開始から1年以内の活動者さまのみです。<br />
                        ※ 月1のみの対応となります。
                    </small>
                </label>
                </fieldset>

                <!-- <label>
                    メールアドレス<small>(任意)</small>：
                    <input type="email" name="email">
                </label> -->

                <label>
                    その他ご要望：
                    <textarea name="message" rows="4"></textarea>
                </label>

                <div id="totalDisplay">合計金額: ¥0</div>
                <button type="submit">送信</button>
                </form>

                <div class="share-buttons">
                    <button id="shareViaEmail" type="button">メールで内容を共有</button>
                    <button id="shareViaX" type="button">X用に内容をコピー</button>
                </div>
            </section>

            <script>
            document.addEventListener("DOMContentLoaded", function () {
                const basePrice = 8000;
                const deadlineSelect = document.querySelector('select[name="count"]');
                const myType = document.getElementById("mvType");
                const coverOptions = document.getElementById("coverOptions");
                const originalOptions = document.getElementById("originalOptions");
                const cgSelect = document.querySelector('select[name="3DCG使用"]');
                const chorusSelect = document.querySelector('select[name="合唱人数"]');
                const contactSelect = document.getElementById("contactSelect");
                const mailaddress = document.getElementById("mailaddress");
                const xDM = document.getElementById("xDM");
                const discordDM = document.getElementById("discordDM");
                const slackDM = document.getElementById("slackDM");
                const checkboxes = document.querySelectorAll('input[type="checkbox"][name="オプション"]');
                const totalDisplay = document.getElementById("totalDisplay");
                const hamburger = document.getElementById("hamburger");
                const navMenu = document.getElementById("nav-menu");
                const form = document.getElementById("requestForm");
                const shareViaEmailBtn = document.getElementById("shareViaEmail");
                const shareViaXBtn = document.getElementById("shareViaX");

                let lastCalculatedTotal = 0;

                function calculate() {
                let total = basePrice;
                let multiplier = 1;

                // 3DCG使用
                switch (cgSelect.value) {
                    case "一部使用":
                    total += 5000;
                    break;
                    case "全部使用":
                    total += 20000;
                    break;
                }

                // 合唱人数
                switch (chorusSelect.value) {
                    case "2人":
                    total += 2000;
                    break;
                    case "3人":
                    total += 4000;
                    break;
                    case "4人":
                    total += 6000;
                    break;
                    case "5人以上":
                    total += 8000;
                    break;
                }

                // チェックボックス項目
                let discount = 0;
                
                checkboxes.forEach((cb) => {
                    if (cb.checked) {
                    switch (cb.value) {
                        case "立ち絵の髪揺れあり":
                        total += 2000;
                        break;
                        case "クレジット記載なし":
                        total += 10000;
                        break;
                        case "著作権譲渡":
                        multiplier *= 1.5;
                        break;
                        case "商用利用":
                        multiplier *= 1.5;
                        break;
                        case "ポートフォリオ掲載不可":
                        multiplier *= 2;
                        break;
                        case "駆け出しクリエイター応援値引き":
                        discount = total / 2;
                        break;
                    }
                    }
                });

                // ⏰ 納期が2週間以内なら追加料金
                if (deadlineSelect.value === "2週間以内") {
                    total += 10000;
                }

                let finalTotal = Math.round(total * multiplier - discount);
                lastCalculatedTotal = finalTotal;
                totalDisplay.textContent = `🧮 参考料金：¥${finalTotal.toLocaleString()}`;
                }

                function generateSummaryText() {
                    const formData = new FormData(form);
                    const selectedOptions = [];
                    formData.getAll('オプション').forEach(option => {
                        selectedOptions.push(`- ${option}`);
                    });

                    let contactDetails = '';
                    const contactMethod = formData.get('contact');

                    if (contactMethod === 'メール') {
                        contactDetails = ` - メールアドレス: ${formData.get('email') || '(未記入)'}`;
                    } else if (contactMethod === 'XのDM') {
                        contactDetails = `  - Xアカウント: ${formData.get('xAccount') || '(未記入)'}`;
                    } else if (contactMethod === 'Discord') {
                        contactDetails = `  - Discordアカウント: ${formData.get('discordAccount') || '(未記入)'}`;
                    } else if (contactMethod === 'Slack') {
                        contactDetails = `  - Slackアカウント: ${formData.get('slackAccount') || '(未記入)'}`;
                    }

                    const summary = `
                    
                    【ご依頼内容】
                    
                    ■お名前:
                    ${formData.get('penname') || ' (未記入) '}
                    
                    ■ご依頼内容:
                    ${formData.get('type') || ' (未選択) '}
                    ${formData.get('type') === 'cover' ? ` - MVスタイル: ${formData.get('coverStyle') || ' (未記入) '}` : ''}
                    
                    ■納期の希望:
                    ${formData.get('count') || ' (未選択) '}
                    
                    ■3DCGの使用:
                    ${formData.get('3DCG使用') || ' (未選択) '}
                    
                    ■合唱人数:
                    ${formData.get('合唱人数') || ' (未選択) '}
                    
                    ■追加オプション:
                    ${selectedOptions.length > 0 ? selectedOptions.join('\n') : 'なし'}
                    
                    ■ご希望の連絡手段:
                    ${contactMethod || ' (未選択) '}
                    ${contactDetails}
                   
                    ■その他ご要望:
                    ${formData.get('message') || ' (未記入) '}
                    
                    ---------------------------------
                    ■参考料金: ¥${lastCalculatedTotal.toLocaleString()}`;
                        return summary.trim();
                }

                shareViaEmailBtn.addEventListener("click", function() {
                    const subject = "ご依頼内容のご相談";
                    const body = encodeURIComponent(generateSummaryText());
                    window.location.href = `mailto:?subject=${subject}&body=${body}`;
                });

                shareViaXBtn.addEventListener("click", function() {
                    const textToCopy = generateSummaryText();
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        alert("ご依頼内容をクリップボードにコピーしました。\nXのDMなどに貼り付けてご利用ください。");
                    }).catch(err => {
                        console.error('コピーに失敗しました', err);
                        alert("コピーに失敗しました。");
                    });
                });

                cgSelect.addEventListener("change", calculate);
                chorusSelect.addEventListener("change", calculate);
                deadlineSelect.addEventListener("change", calculate);
                checkboxes.forEach((cb) => cb.addEventListener("change", calculate));
                contactSelect.addEventListener("change", function () {
                    const selected = contactSelect.value;

                    if (selected === "メール") {
                        mailaddress.style.display = "block";
                    } else {
                        mailaddress.style.display = "none";
                    }

                    if (selected === "XのDM") {
                        xDM.style.display = "block";
                    } else {
                        xDM.style.display = "none";
                    }

                    if (selected === "Discord") {
                        discordDM.style.display = "block";
                    } else {
                        discordDM.style.display = "none";
                    }

                    if (selected === "Slack") {
                        slackDM.style.display = "block";
                    } else {
                        slackDM.style.display = "none";
                    }
                });

                mvType.addEventListener("change", function () {
                    const selected = mvType.value;

                    //初期状態で非表示
                    coverOptions.style.display = "none";
                    originalOptions.style.display = "none";
    
                    if (selected === "cover") {
                        coverOptions.style.display = "block";
                    } else if (selected === "original") {
                        originalOptions.style.display = "block";
                    }
                });

                hamburger.addEventListener("click", function () {
                    hamburger.classList.toggle("active");
                    navMenu.classList.toggle("show");
                });

                //　初回表示
                calculate();
            });
        </script>
    </body>
</html>



